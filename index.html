<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better Search</title>
    <link href="./styles.css" rel="stylesheet">

    <script>
        //Google url format : https://www.google.com/search?q=phone+site:reddit.com+OR+site:quora.com+OR+site:facebook.com&as_qdr=d
        //as_qdr will be used to refer to the timeline

        addEventListener("DOMContentLoaded", ()=>{  

            function uri_generator()
            {
                var uri = "https://www.google.com/search?q=";
                var input_string = document.getElementsByClassName("input-box")[0].value;
                uri = uri+input_string.replace(/ /g, "+");                           //replace all space with "+" and add into url

                var active_parameters = document.getElementsByClassName("active");
                let temp_flag1 = 0, temp_flag2 = 0;
                
                // to add all website active options
                Array.from(active_parameters).forEach(element => {                           
                    if(element.classList.contains("website-option")){
                        let temp;
                        switch (element.innerText){
                            case "Reddit":
                                temp = "reddit.com";
                                break;
                            
                            case "Stack Overflow":
                                temp = "stackoverflow.com";
                                break;
                             
                            case "Twitter":
                                temp = "twitter.com";
                                break;

                            case "Github":
                                temp = "github.com";
                                break;
                        }

                        if(temp_flag1==0){
                            uri = uri + "+site:" + temp;
                            temp_flag1 = 1;
                        }
                        else{                                                                   // before 1st website we dont have to add OR
                            uri = uri + "+OR+site:" + temp;
                        }
                        
                    }
                });
                          
                // to add all file active options
                Array.from(active_parameters).forEach(element => {                           
                    if(element.classList.contains("file-option")){
                        let temp;
                        switch (element.innerText){
                            case ".pdf":
                                temp = "pdf";
                                break;
                            
                            case ".docx":
                                temp = "docx";
                                break;
                                
                            case ".zip":
                                temp = "zip";
                                break;
                             
                            case ".pptx":
                                temp = "pptx";
                                break;
                        }

                        if(temp_flag2==0){
                            uri = uri + "+filetype:" + temp;
                            temp_flag2 = 1;
                        }
                        else{                                                                   // before 1st filetype we dont have to add OR
                            uri = uri + "+OR+filetype:" + temp;
                        }
                        
                    }
                });

                // to add timeline of search results
                // tag only has to be added if any option other than "all time" is selected
                if(document.getElementsByName("time")[0].checked == false)
                {
                    let temp;
                    Array.from(document.getElementsByName("time")).forEach(element => {
                        if(element.checked == true)
                        {
                            temp = element.value;
                        }
                    });
                    uri = uri + "&as_qdr=" + temp;
                }
                
                return uri;
            }

            document.addEventListener("click", (e)=>{                            //to select boxes
                if(e.target.classList.contains("section-option")){
                    e.target.classList.toggle("active");            
                }
            });

            document.addEventListener("click", (e)=>{
                if(e.target.classList.contains("submit-button")){
                    var uri = uri_generator();                          //will collect data and form a url
                    encodeURI(uri);                                     //will encode the url, i.e. replace special chars with escape sequences
                    window.location.replace(uri);                       //will redirect to the constructed uri
                }
            });

        });
    </script>


</head>
<body>
    <div class="body-container">
        <div class="main-container">
            <div class="top">
                <ion-icon name="search-outline"></ion-icon>
                <input type="text" class="search-box" value="" placeholder="Your Search Query">
                <div class="submit-button"><ion-icon name="arrow-forward-outline"></ion-icon></ion-icon></div>
            </div>
            <div class="middle">
                <div class="website-input input-section">
                    <div class="section-heading">Website</div>
                    <div class="section-option-area">
                        <div class="section-option website-option">
                            <ion-icon name="logo-reddit"></ion-icon>
                            Reddit
                        </div>
                        <div class="section-option website-option">
                            <ion-icon name="logo-stackoverflow"></ion-icon>
                            Stack Overflow
                        </div>
                        <div class="section-option website-option">
                            <ion-icon name="logo-twitter"></ion-icon>
                            Twitter
                        </div>
                        <div class="section-option website-option">
                            <ion-icon name="logo-github"></ion-icon>
                            Github
                        </div>
                    </div>
                </div>
                <div class="time-input input-section">
                    <div class="section-heading">Time-Frame</div>
                    <div class="section-option-area">
                        <div class="time-option">
                            <input type="radio" name="time" checked>Any Time
                        </div>
                        <div class="time-option">
                            <input type="radio" name="time" value="d">Past Day
                        </div>
                        <div class="time-option">
                            <input type="radio" name="time" value="w">Past Week   
                        </div>
                        <div class="time-option">
                            <input type="radio" name="time" value="m">Past Month
                        </div>
                        <div class="time-option">
                            <input type="radio" name="time" value="y">Past Year
                        </div>
                    </div>
                </div>
                <div class="format-input input-section">
                    <div class="section-heading">File Format</div>
                    <div class="section-option-area">
                        <div class="section-option file-option">.pdf</div>
                        <div class="section-option file-option">.docx</div>
                        <div class="section-option file-option">.zip</div>
                        <div class="section-option file-option">.pptx</div>
                    </div>
                </div>
            </div>
            <div class="bottom">
    
            </div>
        </div>
    </div>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</body>
</html>